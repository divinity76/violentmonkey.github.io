"use strict";(self.webpackChunkviolentmonkey_github_io=self.webpackChunkviolentmonkey_github_io||[]).push([[583],{1307:function(e,t,n){function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=a(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:String(t)}n.d(t,{RP:function(){return m}});var c=n(9474);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){var a,c,l;a=e,c=t,l=n[t],(c=s(c))in a?Object.defineProperty(a,c,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[c]=l})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const o=c.createContext({});function m(e){const t=c.useContext(o);return c.useMemo((()=>"function"==typeof e?e(t):r(r({},t),e)),[t,e])}},8604:function(e,t,n){n.r(t),n.d(t,{Head:function(){return m.p},default:function(){return p}});var a=n(1307),s=n(9474);function c(e){const t=Object.assign({p:"p",code:"code",a:"a",h3:"h3",span:"span",pre:"pre",ol:"ol",li:"li"},(0,a.RP)(),e.components);return s.createElement(s.Fragment,null,s.createElement(t.p,null,"Since Violentmonkey v2.8.15, scripts are injected with Blob URLs instead of ",s.createElement(t.code,null,"textContent")," in v2.8.13-. Thanks to ",s.createElement(t.a,{href:"https://github.com/evilpie",target:"_blank",rel:"nofollow noopener noreferrer"},"evilpie"),", see ",s.createElement(t.a,{href:"https://github.com/violentmonkey/violentmonkey/pull/246",target:"_blank",rel:"nofollow noopener noreferrer"},"#246"),"."),"\n",s.createElement(t.h3,{id:"before",style:{position:"relative"}},s.createElement(t.a,{href:"#before","aria-label":"before permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Before"),"\n",s.createElement(t.p,null,"In earlier versions, scripts are injected like this:"),"\n",s.createElement(t.pre,{className:"language-javascript"},s.createElement(t.code,{className:"language-javascript code-highlight"},s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token keyword"},"const")," s ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createElement"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token string"},"'script'"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"s",s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"textContent")," ",s.createElement(t.span,{className:"token operator"},"=")," script",s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"appendChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"removeChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"))),"\n",s.createElement(t.p,null,"This way works well on Chrome but does not work on Firefox 57- when page has a limit on inline script by CSP. See ",s.createElement(t.a,{href:"https://bugzilla.mozilla.org/show_bug.cgi?id=1267027",target:"_blank",rel:"nofollow noopener noreferrer"},"bugzilla"),"."),"\n",s.createElement(t.h3,{id:"now",style:{position:"relative"}},s.createElement(t.a,{href:"#now","aria-label":"now permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Now"),"\n",s.createElement(t.p,null,"Since Firefox 58, we have a workaround by injecting scripts like this:"),"\n",s.createElement(t.pre,{className:"language-javascript"},s.createElement(t.code,{className:"language-javascript code-highlight"},s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token keyword"},"const")," b ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token keyword"},"new")," ",s.createElement(t.span,{className:"token class-name"},"Blob"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token punctuation"},"["),"script",s.createElement(t.span,{className:"token punctuation"},"]"),s.createElement(t.span,{className:"token punctuation"},",")," ",s.createElement(t.span,{className:"token punctuation"},"{")," ",s.createElement(t.span,{className:"token literal-property property"},"type"),s.createElement(t.span,{className:"token operator"},":")," ",s.createElement(t.span,{className:"token string"},"'text/javascript'")," ",s.createElement(t.span,{className:"token punctuation"},"}"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token keyword"},"const")," u ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token constant"},"URL"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createObjectURL"),s.createElement(t.span,{className:"token punctuation"},"("),"b",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token keyword"},"const")," s ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createElement"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token string"},"'script'"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"s",s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"src")," ",s.createElement(t.span,{className:"token operator"},"=")," u",s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"appendChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"removeChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token constant"},"URL"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"revokeObjectURL"),s.createElement(t.span,{className:"token punctuation"},"("),"u",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"))),"\n",s.createElement(t.p,null,"Using Blob URLs instead of ",s.createElement(t.code,null,"textContent"),", scripts can be injected to pages on Firefox 58+ too."),"\n",s.createElement(t.h3,{id:"problem",style:{position:"relative"}},s.createElement(t.a,{href:"#problem","aria-label":"problem permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Problem"),"\n",s.createElement(t.p,null,"Then we encountered a problem (v2.8.14, ",s.createElement(t.a,{href:"https://github.com/violentmonkey/violentmonkey/issues/249",target:"_blank",rel:"nofollow noopener noreferrer"},"#249"),"): sometimes the scripts are not injected at all. After debugging for a while, I figured out what was happening."),"\n",s.createElement(t.p,null,"First let's take a look at the injection procedure:"),"\n",s.createElement(t.ol,null,"\n",s.createElement(t.li,null,"inject an initializer to context of page script"),"\n",s.createElement(t.li,null,"load userscripts from content script"),"\n",s.createElement(t.li,null,"post userscripts to the initializer through custom events"),"\n",s.createElement(t.li,null,"execute userscripts"),"\n"),"\n",s.createElement(t.p,null,"The problem is, when the userscripts are loaded and posted to the initializer, the initializer may be not ready yet. As a result, the posted userscripts are discarded."),"\n",s.createElement(t.p,null,"But why won't this happen before?"),"\n",s.createElement(t.p,null,"Because the ",s.createElement(t.code,null,"textContent")," way is synchronous while the ",s.createElement(t.code,null,"src")," way is asynchronous."),"\n",s.createElement(t.p,null,"Using the ",s.createElement(t.code,null,"textContent")," way, the initializer is initialized synchronously when injected. So the initializer is always ready when the userscripts are loaded."),"\n",s.createElement(t.p,null,"But when using a Blob URL, the injection becomes asynchronous. Because it has to fetch the real content first. So the initializer may be not ready yet when the userscripts are laoded. Consequently, no userscript is injected."),"\n",s.createElement(t.p,null,"Here is a demonstration:"),"\n",s.createElement(t.pre,{className:"language-javascript"},s.createElement(t.code,{className:"language-javascript code-highlight"},s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token punctuation"},"{"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token keyword"},"const")," s ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createElement"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token string"},"'script'"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  s",s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"textContent")," ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token string"},"'console.log(1)'"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"appendChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"removeChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token punctuation"},"}"),"\n"),s.createElement(t.span,{className:"code-line"},"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token punctuation"},"{"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token keyword"},"const")," s ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createElement"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token string"},"'script'"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token keyword"},"const")," b ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token keyword"},"new")," ",s.createElement(t.span,{className:"token class-name"},"Blob"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token punctuation"},"["),s.createElement(t.span,{className:"token string"},"'console.log(2)'"),s.createElement(t.span,{className:"token punctuation"},"]"),s.createElement(t.span,{className:"token punctuation"},",")," ",s.createElement(t.span,{className:"token punctuation"},"{")," ",s.createElement(t.span,{className:"token literal-property property"},"type"),s.createElement(t.span,{className:"token operator"},":")," ",s.createElement(t.span,{className:"token string"},"'text/javascript'")," ",s.createElement(t.span,{className:"token punctuation"},"}"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token keyword"},"const")," u ",s.createElement(t.span,{className:"token operator"},"=")," ",s.createElement(t.span,{className:"token constant"},"URL"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"createObjectURL"),s.createElement(t.span,{className:"token punctuation"},"("),"b",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  s",s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"src")," ",s.createElement(t.span,{className:"token operator"},"=")," u",s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"appendChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token dom variable"},"document"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token property-access"},"body"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"removeChild"),s.createElement(t.span,{className:"token punctuation"},"("),"s",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},"  ",s.createElement(t.span,{className:"token constant"},"URL"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"revokeObjectURL"),s.createElement(t.span,{className:"token punctuation"},"("),"u",s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token punctuation"},"}"),"\n"),s.createElement(t.span,{className:"code-line"},"\n"),s.createElement(t.span,{className:"code-line"},s.createElement(t.span,{className:"token console class-name"},"console"),s.createElement(t.span,{className:"token punctuation"},"."),s.createElement(t.span,{className:"token method function property-access"},"log"),s.createElement(t.span,{className:"token punctuation"},"("),s.createElement(t.span,{className:"token number"},"3"),s.createElement(t.span,{className:"token punctuation"},")"),s.createElement(t.span,{className:"token punctuation"},";"),"\n"))),"\n",s.createElement(t.p,null,"By running the code above in a browser (e.g. Chrome), we got output as below:"),"\n",s.createElement(t.pre,null,s.createElement(t.code,{className:"code-highlight"},s.createElement(t.span,{className:"code-line"},"1\n"),s.createElement(t.span,{className:"code-line"},"3\n"),s.createElement(t.span,{className:"code-line"},"2\n"))),"\n",s.createElement(t.h3,{id:"conclusion",style:{position:"relative"}},s.createElement(t.a,{href:"#conclusion","aria-label":"conclusion permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Conclusion"),"\n",s.createElement(t.p,null,"So we just need to ensure that the initializer is ready when posting userscripts to it."),"\n",s.createElement(t.p,null,"Finally, it works on Chrome any and Firefox v58+, even on pages with CSP limitations."))}var l=function(e={}){const{wrapper:t}=Object.assign({},(0,a.RP)(),e.components);return t?s.createElement(t,e,s.createElement(c,e)):c(e)},r=n(2349),o=n(301),m=n(9144);function i({location:e,data:t,children:n}){const{mdx:a}=t,c=(0,s.useRef)(),{pathname:l}=e,m="/"===l;return s.createElement(o.A,{location:e,sidebar:a.frontmatter.sidebar},s.createElement("main",{className:"flex-1 has-toc"},!m&&s.createElement("section",{className:"mb-10 pt-1"},s.createElement("h1",null,a.frontmatter.title)),s.createElement("section",{className:"items-start with-toc"},!m&&s.createElement(r.A,{data:a.tableOfContents,articleRef:c}),s.createElement("article",{className:"flex-1 min-w-0 mr-4",ref:c},n)),s.createElement("section",null,s.createElement("hr"),a.fields.slug.startsWith("posts/")&&s.createElement("div",{className:"mb-6"},s.createElement("em",null,"Published at ",a.frontmatter.date)))))}function p(e){return s.createElement(i,e,s.createElement(l,e))}},8931:function(e,t,n){n.d(t,{A:function(){return c}});let a=!1;try{const e=Object.defineProperty({},"passive",{get(){a=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(l){}const s=!!a&&{passive:!0};function c(e){return window.addEventListener("scroll",e,s),()=>window.removeEventListener("scroll",e,s)}},9144:function(e,t,n){n.d(t,{p:function(){return l}});var a=n(9474),s=n(8136),c=n(1713);function l(){const{site:{siteMetadata:{title:e,subtitle:t}}}=(0,s.useStaticQuery)("3202921338");return a.createElement(a.Fragment,null,a.createElement("title",null,e),a.createElement("meta",{name:"description",content:t}),a.createElement("meta",{name:"google-site-verification",content:"OKMYmcVuMfm9H_UjfNXPzRb2c0QoBtmZ7v1KwHNXnRQ"}),a.createElement("link",{rel:"shortcut icon",type:"image/png",href:c.A}))}},301:function(e,t,n){n.d(t,{A:function(){return y}});var a=n(8595),s=n(9474),c=(n(3763),n(993),n(1622),n(5376),n(8136));const l=(r=function(e){const{allMdx:{nodes:t}}=(0,c.useStaticQuery)("1116475411"),n=(0,s.useMemo)((()=>(null==e?void 0:e.match)&&(null==t?void 0:t.filter((t=>{var n;return(null===(n=t.frontmatter.sidebar)||void 0===n?void 0:n.match)===e.match})).sort(((e,t)=>e.frontmatter.sidebar.order-t.frontmatter.sidebar.order)))),[e,t]),[a,l]=(0,s.useState)(!1);return{matchedNodes:n,show:a,setShow:l,toggle:()=>{l(!a)}}},o=s.createContext(null),{Provider:function(e){var t=r(e.initialState);return s.createElement(o.Provider,{value:t},e.children)},useContainer:function(){var e=s.useContext(o);if(null===e)throw new Error("Component must be wrapped with <Container.Provider>");return e}});var r,o,m=n(4432),i=(n(6851),n(2445),n(8931));function p(){const e=(0,s.useRef)();return(0,s.useEffect)((()=>(0,i.A)((()=>{const t=document.documentElement,n=(document.body.scrollTop||t.scrollTop)/(t.scrollHeight-t.clientHeight),a=Math.min(1,n);e.current.style.transform=`scaleX(${a})`})))),s.createElement("div",{className:"w-full h-px"},s.createElement("div",{className:"w-full h-full origin-left bg-yellow-500 scale-x-0",ref:e}))}function u(){const[e,t]=(0,s.useState)(null);return e?s.createElement("div",{className:"bg-orange-200 px-4 text-sm flex","data-ga-category":"banner"},s.createElement("div",{className:"flex-1",dangerouslySetInnerHTML:{__html:e}}),s.createElement("div",{onClick:()=>{t(null)},className:"cursor-pointer text-gray-600","data-ga-label":"hide"},"✗")):null}function E(e){const{matchedNodes:t,toggle:n}=l.useContainer(),{data:a}=e,r=a.allMdx.nodes.reduce(((e,t)=>(t.frontmatter.redirect_from.forEach((n=>{e[n]=`/${t.fields.slug}`})),e)),{});return s.createElement("header",{className:"sticky top-0 left-0 right-0 bg-white z-10"},s.createElement("nav",null,s.createElement(c.Link,{to:"/",className:"nav-icon sm:hidden"},s.createElement("svg",{viewBox:"0 0 24 24"},s.createElement("path",{d:"M12 0l-12 12h4v12h5v-8h6v8h5v-12h4z"}))),t&&s.createElement("a",{className:"nav-icon lg:hidden",onClick:e=>{e.stopPropagation(),n()}},s.createElement("svg",{viewBox:"0 0 24 24"},s.createElement("path",{d:"M0 2h24v4h-24zM0 10h24v4h-24zM0 18h24v4h-24z"}))),s.createElement(c.Link,{to:"/",className:"brand hidden sm:block"},"Violentmonkey"),s.createElement("span",{className:"flex-1"}),s.createElement("div",{className:"overflow-auto min-w-0 flex whitespace-no-wrap"},a.site.siteMetadata.menu.map((e=>s.createElement(c.Link,{className:"nav-item",key:e.path,to:r[e.path]||e.path,activeClassName:"active",partiallyActive:!0},e.label))))),s.createElement(p,null))}var d=e=>s.createElement(c.StaticQuery,{query:"1700780748",render:t=>s.createElement(s.Fragment,null,s.createElement(u,null),s.createElement(E,(0,m.A)({},e,{data:t})))});function N(e){const{data:{site:{siteMetadata:{copyright:t,footer:n}}}}=e;return s.createElement("footer",{className:"flex mt-10 p-6 pb-16 border-t border-gray-400 lg:pb-6"},s.createElement("div",null,"Violentmonkey ",t),n.map((e=>s.createElement(c.Link,{className:"mx-2",key:e.path,to:e.path},e.label))))}var h=e=>s.createElement(c.StaticQuery,{query:"2344890832",render:t=>s.createElement(N,(0,m.A)({},e,{data:t}))});function k(){const{matchedNodes:e,setShow:t}=l.useContainer();return(0,s.useEffect)((()=>{if(e){const e=()=>{t(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}}),[e,t]),e?s.createElement("aside",{className:"sidebar"},s.createElement("ul",null,e.map(((e,t)=>s.createElement("li",{key:t},s.createElement(c.Link,{to:`/${e.fields.slug}`,activeClassName:"active"},e.frontmatter.title)))))):null}function f(){const[e,t]=(0,s.useState)(!1);return e?s.createElement("div",{className:"fixed bottom-0 right-0 w-full h-full flex flex-col items-end z-10 max-w-[320px] max-h-[450px]"},s.createElement("div",{className:"p-2 cursor-pointer",onClick:()=>t(!1)},s.createElement("svg",{viewBox:"0 0 12 12",className:"w-4 h-4"},s.createElement("path",{d:"M0 1L11 12L12 11L1 0zM11 0L0 11L1 12L12 1z",stroke:"none",fill:"currentColor"}))),s.createElement("iframe",{className:"flex-1 w-full",src:"https://discord.com/widget?id=995346102003965952&theme=dark",sandbox:"allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"})):s.createElement("a",{className:"fixed bottom-0 right-8 px-8 py-2 bg-blue-500 hover:bg-blue-600 text-white hover:text-white rounded-t-lg uppercase cursor-pointer",onClick:()=>t(!0)},"Open Chat")}const v=["sidebar"];function b(e){const{location:{pathname:t},children:n}=e,{show:a}=l.useContainer();return"/offline-plugin-app-shell-fallback/"===t?null:s.createElement(s.Fragment,null,s.createElement(d,null),s.createElement("div",{className:"relative flex z-0 "+(a?"sidebar-open":"")},s.createElement(k,null),n),s.createElement(h,null),s.createElement(f,null))}var y=e=>{let{sidebar:t}=e,n=(0,a.A)(e,v);return s.createElement(l.Provider,{initialState:t},s.createElement(b,n))}},2349:function(e,t,n){n.d(t,{A:function(){return r}});n(116),n(2445);var a=n(9474),s=n(8136),c=n(8931);function l({items:e}){return a.createElement("ul",null,e.map(((e,t)=>{const n=e.url.indexOf("#"),c=n<0?"#":e.url.slice(n);return a.createElement("li",{key:t},a.createElement(s.Link,{to:c},e.title),e.items&&a.createElement(l,{items:e.items}))})))}function r(e){const{className:t,data:n,articleRef:s}=e,r=(0,a.useRef)(),o=(0,a.useRef)();return(0,a.useEffect)((()=>{if(!n)return;const e=Array.from(r.current.querySelectorAll("a"));e.forEach((e=>{const t=decodeURIComponent(e.href.split("#")[1]||"");if(e.dataset.id=t,s.current){const n=s.current.querySelector(`#${CSS.escape(t)}`);n&&(e.textContent=n.textContent.trim())}}));return(0,c.A)((()=>{if(!s.current||!r.current)return;const{scrollTop:t}=document.body,n=e.map((e=>{const{id:n}=e.dataset,a=s.current.querySelector(`#${CSS.escape(n)}`);return a&&{id:n,a:e,offset:a.getBoundingClientRect().top-t-70}})).filter(Boolean),{a:a}=n.find(((e,t)=>{const a=n[t+1];return a&&a.offset>0}))||{};o.current&&(o.current.className=""),a&&(a.className="active"),o.current=a}))})),a.createElement("section",{className:`toc ${t||""}`,ref:r},(null==n?void 0:n.items)&&a.createElement(a.Fragment,null,a.createElement("h2",null,"Table of Contents"),a.createElement(l,{items:n.items})))}},1713:function(e,t,n){t.A=n.p+"static/vm-6437e4e5a400c6eff1c23ead4d549b0a.png"}}]);
//# sourceMappingURL=component---src-templates-post-index-js-content-file-path-content-posts-inject-scripts-with-blob-urls-md-c36e1c51944e3bdec63f.js.map